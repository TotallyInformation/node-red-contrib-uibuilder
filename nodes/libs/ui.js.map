{
  "version": 3,
  "sources": ["src/libs/ui.js"],
  "sourcesContent": ["// src/front-end-module/ui.js\nvar log;\nvar Ui = class Ui2 {\n  /** Called when `new Ui(...)` is called\n   * @param {*} extLog A fn that returns a fn for logging\n   * @param {*} jsonHighlight A function that returns a highlighted HTML of JSON input\n   */\n  constructor(extLog, jsonHighlight) {\n    if (!document) {\n      log(0, \"Ui:constructor\", \"Current environment does not include `document`, UI functions cannot be used.\")();\n    }\n    log = extLog;\n    this.syntaxHighlight = jsonHighlight;\n  }\n  /** Directly manage UI via JSON\n   * @param {object} json Either an object containing {_ui: {}} or simply simple {} containing ui instructions\n   */\n  ui(json) {\n    let msg = {};\n    if (json._ui)\n      msg = json;\n    else\n      msg._ui = json;\n    this._uiManager(msg);\n  }\n  // TODO Add multi-slot\n  /** Replace or add an HTML element's slot from text or an HTML string\n   * Will use DOMPurify if that library has been loaded to window.\n   * param {*} ui Single entry from the msg._ui property\n   * @param {Element} el Reference to the element that we want to update\n   * @param {*} component The component we are trying to add/replace\n   */\n  replaceSlot(el, component) {\n    if (!component.slot)\n      return;\n    if (!el)\n      return;\n    if (window[\"DOMPurify\"])\n      component.slot = window[\"DOMPurify\"].sanitize(component.slot);\n    el.innerHTML = component.slot;\n  }\n  /** Replace or add an HTML element's slot from a Markdown string\n   * Only does something if the markdownit library has been loaded to window.\n   * Will use DOMPurify if that library has been loaded to window.\n   * @param {Element} el Reference to the element that we want to update\n   * @param {*} component The component we are trying to add/replace\n   */\n  replaceSlotMarkdown(el, component) {\n    if (!el)\n      return;\n    if (!window[\"markdownit\"])\n      return;\n    if (!component.slotMarkdown)\n      return;\n    const opts = {\n      // eslint-disable-line object-shorthand\n      html: true,\n      linkify: true,\n      _highlight: true,\n      langPrefix: \"language-\",\n      highlight(str, lang) {\n        if (lang && window[\"hljs\"] && window[\"hljs\"].getLanguage(lang)) {\n          try {\n            return `<pre class=\"highlight\" data-language=\"${lang.toUpperCase()}\">\n                                <code class=\"language-${lang}\">${window[\"hljs\"].highlightAuto(str).value}</code></pre>`;\n          } finally {\n          }\n        }\n        return `<pre class=\"highlight\"><code>${md.utils.escapeHtml(str)}</code></pre>`;\n      }\n    };\n    const md = window[\"markdownit\"](opts);\n    component.slotMarkdown = md.render(component.slotMarkdown);\n    if (window[\"DOMPurify\"])\n      component.slotMarkdown = window[\"DOMPurify\"].sanitize(component.slotMarkdown);\n    el.innerHTML = component.slotMarkdown;\n  }\n  /** Attach a new remote script to the end of HEAD synchronously\n   * NOTE: It takes too long for most scripts to finish loading\n   *       so this is pretty useless to work with the dynamic UI features directly.\n   * @param {string} url The url to be used in the script src attribute\n   */\n  loadScriptSrc(url) {\n    const newScript = document.createElement(\"script\");\n    newScript.src = url;\n    newScript.async = false;\n    document.head.appendChild(newScript);\n  }\n  /** Attach a new remote stylesheet link to the end of HEAD synchronously\n   * NOTE: It takes too long for most scripts to finish loading\n   *       so this is pretty useless to work with the dynamic UI features directly.\n   * @param {string} url The url to be used in the style link href attribute\n   */\n  loadStyleSrc(url) {\n    const newStyle = document.createElement(\"link\");\n    newStyle.href = url;\n    newStyle.rel = \"stylesheet\";\n    newStyle.type = \"text/css\";\n    document.head.appendChild(newStyle);\n  }\n  /** Attach a new text script to the end of HEAD synchronously\n   * NOTE: It takes too long for most scripts to finish loading\n   *       so this is pretty useless to work with the dynamic UI features directly.\n   * @param {string} textFn The text to be loaded as a script\n   */\n  loadScriptTxt(textFn) {\n    const newScript = document.createElement(\"script\");\n    newScript.async = false;\n    newScript.textContent = textFn;\n    document.head.appendChild(newScript);\n  }\n  /** Attach a new text stylesheet to the end of HEAD synchronously\n   * NOTE: It takes too long for most scripts to finish loading\n   *       so this is pretty useless to work with the dynamic UI features directly.\n   * @param {string} textFn The text to be loaded as a stylesheet\n   */\n  loadStyleTxt(textFn) {\n    const newStyle = document.createElement(\"style\");\n    newStyle.textContent = textFn;\n    document.head.appendChild(newStyle);\n  }\n  // TODO - Allow notify to sit in corners rather than take over the screen\n  /** Show a pop-over \"toast\" dialog or a modal alert\n   * Refs: https://www.w3.org/WAI/ARIA/apg/example-index/dialog-modal/alertdialog.html,\n   *       https://www.w3.org/WAI/ARIA/apg/example-index/dialog-modal/dialog.html,\n   *       https://www.w3.org/WAI/ARIA/apg/patterns/dialogmodal/\n   * @param {\"notify\"|\"alert\"} type Dialog type\n   * @param {object} ui standardised ui data\n   * @param {object} [msg] msg.payload/msg.topic - only used if a string. Optional.\n   * @returns {void}\n   */\n  showDialog(type, ui, msg) {\n    let content = \"\";\n    if (msg.payload && typeof msg.payload === \"string\")\n      content += msg.payload;\n    if (ui.content)\n      content += ui.content;\n    if (content === \"\") {\n      log(1, \"Ui:showDialog\", \"Toast content is blank. Not shown.\")();\n      return;\n    }\n    if (!ui.title && msg.topic)\n      ui.title = msg.topic;\n    if (ui.title)\n      content = `<p class=\"toast-head\">${ui.title}</p><p>${content}</p>`;\n    if (ui.noAutohide)\n      ui.noAutoHide = ui.noAutohide;\n    if (ui.noAutoHide)\n      ui.autohide = !ui.noAutoHide;\n    if (ui.autoHideDelay) {\n      if (!ui.autohide)\n        ui.autohide = true;\n      ui.delay = ui.autoHideDelay;\n    } else\n      ui.autoHideDelay = 1e4;\n    if (!Object.prototype.hasOwnProperty.call(ui, \"autohide\"))\n      ui.autohide = true;\n    if (type === \"alert\") {\n      ui.modal = true;\n      ui.autohide = false;\n      content = `<svg viewBox=\"0 0 192.146 192.146\" style=\"width:30;background-color:transparent;\"><path d=\"M108.186 144.372c0 7.054-4.729 12.32-12.037 12.32h-.254c-7.054 0-11.92-5.266-11.92-12.32 0-7.298 5.012-12.31 12.174-12.31s11.91 4.992 12.037 12.31zM88.44 125.301h15.447l2.951-61.298H85.46l2.98 61.298zm101.932 51.733c-2.237 3.664-6.214 5.921-10.493 5.921H12.282c-4.426 0-8.51-2.384-10.698-6.233a12.34 12.34 0 0 1 .147-12.349l84.111-149.22c2.208-3.722 6.204-5.96 10.522-5.96h.332c4.445.107 8.441 2.618 10.513 6.546l83.515 149.229c1.993 3.8 1.905 8.363-.352 12.066zm-10.493-6.4L96.354 21.454l-84.062 149.18h167.587z\" /></svg> ${content}`;\n    }\n    let toaster = document.getElementById(\"toaster\");\n    if (toaster === null) {\n      toaster = document.createElement(\"div\");\n      toaster.id = \"toaster\";\n      toaster.title = \"Click to clear all notifcations\";\n      toaster.setAttribute(\"class\", \"toaster\");\n      toaster.setAttribute(\"role\", \"dialog\");\n      toaster.setAttribute(\"arial-label\", \"Toast message\");\n      toaster.onclick = function() {\n        toaster.remove();\n      };\n      document.body.insertAdjacentElement(\"afterbegin\", toaster);\n    }\n    const toast = document.createElement(\"div\");\n    toast.title = \"Click to clear this notifcation\";\n    toast.setAttribute(\"class\", `toast ${ui.variant ? ui.variant : \"\"} ${type}`);\n    toast.innerHTML = content;\n    toast.setAttribute(\"role\", \"alertdialog\");\n    if (ui.modal)\n      toast.setAttribute(\"aria-modal\", ui.modal);\n    toast.onclick = function(evt) {\n      evt.stopPropagation();\n      toast.remove();\n      if (toaster.childElementCount < 1)\n        toaster.remove();\n    };\n    if (type === \"alert\") {\n    }\n    toaster.insertAdjacentElement(ui.appendToast === true ? \"beforeend\" : \"afterbegin\", toast);\n    if (ui.autohide === true) {\n      setInterval(() => {\n        toast.remove();\n        if (toaster.childElementCount < 1)\n          toaster.remove();\n      }, ui.autoHideDelay);\n    }\n  }\n  // --- End of showDialog ---\n  /** Show a browser notification if the browser and the user allows it\n   * @param {object} config Notification config data\n   * @returns {Promise} Resolves on close or click event, returns the event.\n   */\n  _showNotification(config) {\n    if (config.topic && !config.title)\n      config.title = config.topic;\n    if (!config.title)\n      config.title = \"uibuilder notification\";\n    if (config.payload && !config.body)\n      config.body = config.payload;\n    if (!config.body)\n      config.body = \" No message given.\";\n    try {\n      const notify = new Notification(config.title, config);\n      return new Promise((resolve, reject) => {\n        notify.addEventListener(\"close\", (ev) => {\n          ev.currentTarget.userAction = \"close\";\n          resolve(ev);\n        });\n        notify.addEventListener(\"click\", (ev) => {\n          ev.currentTarget.userAction = \"click\";\n          resolve(ev);\n        });\n        notify.addEventListener(\"error\", (ev) => {\n          ev.currentTarget.userAction = \"error\";\n          reject(ev);\n        });\n      });\n    } catch (e) {\n      return Promise.reject(new Error(\"Browser refused to create a Notification\"));\n    }\n  }\n  /** Show a browser notification if possible. Returns a promise\n   * Config can be a simple string, a Node-RED msg (topic as title, payload as body)\n   * or a Notifications API options object + config.title string.\n   * Config ref: https://developer.mozilla.org/en-US/docs/Web/API/Notification/Notification\n   * @param {object|string} config Notification config object or simple message string\n   * @returns {Promise} Resolves on close or click event, returns the event.\n   */\n  async notification(config) {\n    if (typeof config === \"string\") {\n      config = { body: config };\n    }\n    if (typeof Notification === \"undefined\")\n      return Promise.reject(new Error(\"Notifications not available in this browser\"));\n    let permit = Notification.permission;\n    if (permit === \"denied\") {\n      return Promise.reject(new Error(\"Notifications not permitted by user\"));\n    } else if (permit === \"granted\") {\n      return this._showNotification(config);\n    } else {\n      permit = await Notification.requestPermission();\n      if (permit === \"granted\") {\n        return this._showNotification(config);\n      }\n      return Promise.reject(new Error(\"Notifications not permitted by user\"));\n    }\n  }\n  /** Load a dynamic UI from a JSON web reponse\n   * @param {string} url URL that will return the ui JSON\n   */\n  loadui(url) {\n    if (!fetch) {\n      log(0, \"Ui:loadui\", \"Current environment does not include `fetch`, skipping.\")();\n      return;\n    }\n    if (!url) {\n      log(0, \"Ui:loadui\", \"url parameter must be provided, skipping.\")();\n      return;\n    }\n    fetch(url).then((response) => {\n      if (response.ok === false) {\n        throw new Error(`Could not load '${url}'. Status ${response.status}, Error: ${response.statusText}`);\n      }\n      log(\"trace\", \"Ui:loadui:then1\", `Loaded '${url}'. Status ${response.status}, ${response.statusText}`)();\n      const contentType = response.headers.get(\"content-type\");\n      if (!contentType || !contentType.includes(\"application/json\")) {\n        throw new TypeError(`Fetch '${url}' did not return JSON, ignoring`);\n      }\n      return response.json();\n    }).then((data) => {\n      if (data !== void 0) {\n        log(\"trace\", \"Ui:loadui:then2\", \"Parsed JSON successfully obtained\")();\n        this._uiManager({ _ui: data });\n        return true;\n      }\n      return false;\n    }).catch((err) => {\n      log(\"warn\", \"Ui:loadui:catch\", \"Error. \", err)();\n    });\n  }\n  // --- end of loadui\n  // Namespaces - See https://stackoverflow.com/a/52572048/1309986\n  // const NAMESPACES = {\n  //     svg: 'http://www.w3.org/2000/svg',\n  //     html: 'http://www.w3.org/1999/xhtml',\n  //     xml: 'http://www.w3.org/XML/1998/namespace',\n  //     xlink: 'http://www.w3.org/1999/xlink',\n  //     xmlns: 'http://www.w3.org/2000/xmlns/' // sic for the final slash...\n  // }\n  /** Enhance an HTML element that is being composed with ui data\n   *  such as ID, attribs, event handlers, custom props, etc.\n   * @param {*} el HTML Element to enhance\n   * @param {*} comp Individual uibuilder ui component spec\n   */\n  _uiComposeComponent(el, comp) {\n    if (comp.attributes) {\n      Object.keys(comp.attributes).forEach((attrib) => {\n        if (attrib === \"value\")\n          el.value = comp.attributes[attrib];\n        if (attrib.startsWith(\"xlink:\"))\n          el.setAttributeNS(\"http://www.w3.org/1999/xlink\", attrib, comp.attributes[attrib]);\n        else\n          el.setAttribute(attrib, comp.attributes[attrib]);\n      });\n    }\n    if (comp.id)\n      el.setAttribute(\"id\", comp.id);\n    if (comp.type === \"svg\") {\n      el.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns\", \"http://www.w3.org/2000/svg\");\n      el.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\n    }\n    if (comp.events) {\n      Object.keys(comp.events).forEach((type) => {\n        if (type.toLowerCase === \"onclick\")\n          type = \"click\";\n        try {\n          el.addEventListener(type, (evt) => {\n            new Function(\"evt\", `${comp.events[type]}(evt)`)(evt);\n          });\n        } catch (err) {\n          log(\"error\", \"Ui:_uiComposeComponent\", `Add event '${type}' for element '${comp.type}': Cannot add event handler. ${err.message}`)();\n        }\n      });\n    }\n    if (comp.properties) {\n      Object.keys(comp.properties).forEach((prop) => {\n        el[prop] = comp.properties[prop];\n      });\n    }\n    if (comp.slot) {\n      this.replaceSlot(el, comp);\n    }\n    if (comp.slotMarkdown) {\n      this.replaceSlotMarkdown(el, comp);\n    }\n  }\n  uiEnhanceElement(el, comp) {\n    this._uiComposeComponent(el, comp);\n  }\n  /** Extend an HTML Element with appended elements using ui components\n   * NOTE: This fn follows a strict hierarchy of added components.\n   * @param {HTMLElement} parentEl The parent HTML Element we want to append to\n   * @param {*} components The ui component(s) we want to add\n   * @param {string} [ns] Optional. The namespace to use.\n   */\n  _uiExtendEl(parentEl, components, ns = \"\") {\n    components.forEach((compToAdd, i) => {\n      log(\"trace\", `Ui:_uiExtendEl:components-forEach:${i}`, compToAdd)();\n      let newEl;\n      compToAdd.ns = ns;\n      if (compToAdd.ns === \"html\") {\n        newEl = parentEl;\n        parentEl.innerHTML = compToAdd.slot;\n      } else if (compToAdd.ns === \"svg\") {\n        newEl = document.createElementNS(\"http://www.w3.org/2000/svg\", compToAdd.type);\n        this._uiComposeComponent(newEl, compToAdd);\n        parentEl.appendChild(newEl);\n      } else {\n        newEl = document.createElement(compToAdd.type === \"html\" ? \"div\" : compToAdd.type);\n        this._uiComposeComponent(newEl, compToAdd);\n        parentEl.appendChild(newEl);\n      }\n      if (compToAdd.components) {\n        this._uiExtendEl(newEl, compToAdd.components, compToAdd.ns);\n      }\n    });\n  }\n  // Vue dynamic inserts Don't really work ...\n  // _uiAddVue(ui, isRecurse) {\n  //     // must be Vue\n  //     // must have only 1 root element\n  //     const compToAdd = ui.components[0]\n  //     const newEl = document.createElement(compToAdd.type)\n  //     if (!compToAdd.slot && ui.payload) compToAdd.slot = ui.payload\n  //     this._uiComposeComponent(newEl, compToAdd)\n  //     // If nested components, go again - but don't pass payload to sub-components\n  //     if (compToAdd.components) {\n  //         this._uiExtendEl(newEl, compToAdd.components)\n  //     }\n  //     console.log('MAGIC: ', this.magick, newEl, newEl.outerHTML)()\n  //     this.set('magick', newEl.outerHTML)\n  //     // if (compToAdd.id) newEl.setAttribute('ref', compToAdd.id)\n  //     // if (elParent.id) newEl.setAttribute('data-parent', elParent.id)\n  // }\n  // TODO Add check if ID already exists\n  // TODO Allow single add without using components array\n  /** Handle incoming msg._ui add requests\n   * @param {*} ui Standardised msg._ui property object. Note that payload and topic are appended to this object\n   * @param {boolean} isRecurse Is this a recursive call?\n   */\n  _uiAdd(ui, isRecurse) {\n    log(\"trace\", \"Ui:_uiManager:add\", \"Starting _uiAdd\")();\n    ui.components.forEach((compToAdd, i) => {\n      log(\"trace\", `Ui:_uiAdd:components-forEach:${i}`, \"Component to add: \", compToAdd)();\n      let newEl;\n      switch (compToAdd.type) {\n        case \"html\": {\n          compToAdd.ns = \"html\";\n          newEl = document.createElement(\"div\");\n          break;\n        }\n        case \"svg\": {\n          compToAdd.ns = \"svg\";\n          newEl = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n          break;\n        }\n        default: {\n          compToAdd.ns = \"dom\";\n          newEl = document.createElement(compToAdd.type);\n          break;\n        }\n      }\n      if (!compToAdd.slot && ui.payload)\n        compToAdd.slot = ui.payload;\n      this._uiComposeComponent(newEl, compToAdd);\n      let elParent;\n      if (compToAdd.parentEl) {\n        elParent = compToAdd.parentEl;\n      } else if (ui.parentEl) {\n        elParent = ui.parentEl;\n      } else if (compToAdd.parent) {\n        elParent = document.querySelector(compToAdd.parent);\n      } else if (ui.parent) {\n        elParent = document.querySelector(ui.parent);\n      }\n      if (!elParent) {\n        log(\"info\", \"Ui:_uiAdd\", \"No parent found, adding to body\")();\n        elParent = document.querySelector(\"body\");\n      }\n      if (compToAdd.position && compToAdd.position === \"first\") {\n        elParent.insertBefore(newEl, elParent.firstChild);\n      } else if (compToAdd.position && Number.isInteger(Number(compToAdd.position))) {\n        elParent.insertBefore(newEl, elParent.children[compToAdd.position]);\n      } else {\n        elParent.appendChild(newEl);\n      }\n      if (compToAdd.components) {\n        this._uiExtendEl(newEl, compToAdd.components, compToAdd.ns);\n      }\n    });\n  }\n  // --- end of _uiAdd ---\n  // TODO Add better tests for failures (see comments)\n  /** Handle incoming _ui remove requests\n   * @param {*} ui Standardised msg._ui property object. Note that payload and topic are appended to this object\n   * @param {boolean} all Optional, default=false. If true, will remove ALL found elements, otherwise only the 1st is removed\n   */\n  _uiRemove(ui, all = false) {\n    ui.components.forEach((compToRemove) => {\n      let els;\n      if (all !== true)\n        els = [document.querySelector(compToRemove)];\n      else\n        els = document.querySelectorAll(compToRemove);\n      els.forEach((el) => {\n        try {\n          el.remove();\n        } catch (err) {\n          log(\"trace\", \"Ui:_uiRemove\", `Could not remove. ${err.message}`)();\n        }\n      });\n    });\n  }\n  // --- end of _uiRemove ---\n  /** Handle incoming _ui replace requests\n   * @param {*} ui Standardised msg._ui property object. Note that payload and topic are appended to this object\n   */\n  _uiReplace(ui) {\n    log(\"trace\", \"Ui:_uiReplace\", \"Starting\")();\n    ui.components.forEach((compToReplace, i) => {\n      log(\"trace\", `Ui:_uiReplace:components-forEach:${i}`, \"Component to replace: \", compToReplace)();\n      let elToReplace;\n      if (compToReplace.id) {\n        elToReplace = document.getElementById(compToReplace.id);\n      } else if (compToReplace.selector || compToReplace.select) {\n        elToReplace = document.querySelector(compToReplace.selector);\n      } else if (compToReplace.name) {\n        elToReplace = document.querySelector(`[name=\"${compToReplace.name}\"]`);\n      } else if (compToReplace.type) {\n        elToReplace = document.querySelector(compToReplace.type);\n      }\n      log(\"trace\", `Ui:_uiReplace:components-forEach:${i}`, \"Element to replace: \", elToReplace)();\n      if (elToReplace === void 0 || elToReplace === null) {\n        log(\"trace\", `Ui:_uiReplace:components-forEach:${i}:noReplace`, \"Cannot find the DOM element. Adding instead.\", compToReplace)();\n        this._uiAdd({ components: [compToReplace] }, false);\n        return;\n      }\n      let newEl;\n      switch (compToReplace.type) {\n        case \"html\": {\n          compToReplace.ns = \"html\";\n          newEl = document.createElement(\"div\");\n          break;\n        }\n        case \"svg\": {\n          compToReplace.ns = \"svg\";\n          newEl = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n          break;\n        }\n        default: {\n          compToReplace.ns = \"dom\";\n          newEl = document.createElement(compToReplace.type);\n          break;\n        }\n      }\n      this._uiComposeComponent(newEl, compToReplace);\n      elToReplace.replaceWith(newEl);\n      if (compToReplace.components) {\n        this._uiExtendEl(newEl, compToReplace.components, compToReplace.ns);\n      }\n    });\n  }\n  // --- end of _uiReplace ---\n  // TODO Allow single add without using components array\n  // TODO Allow sub-components\n  // TODO Add multi-slot capability\n  /** Handle incoming _ui update requests\n   * @param {*} ui Standardised msg._ui property object. Note that payload and topic are appended to this object\n   */\n  _uiUpdate(ui) {\n    log(\"trace\", \"Ui:_uiManager:update\", \"Starting _uiUpdate\")();\n    if (!ui.components)\n      ui.components = [Object.assign({}, ui)];\n    ui.components.forEach((compToUpd, i) => {\n      log(\"trace\", \"_uiUpdate:components-forEach\", `Component #${i}`, compToUpd)();\n      let elToUpd;\n      if (compToUpd.id) {\n        elToUpd = document.querySelectorAll(`#${compToUpd.id}`);\n      } else if (compToUpd.selector || compToUpd.select) {\n        elToUpd = document.querySelectorAll(compToUpd.selector);\n      } else if (compToUpd.name) {\n        elToUpd = document.querySelectorAll(`[name=\"${compToUpd.name}\"]`);\n      } else if (compToUpd.type) {\n        elToUpd = document.querySelectorAll(compToUpd.type);\n      }\n      if (elToUpd === void 0 || elToUpd.length < 1) {\n        log(\"warn\", \"Ui:_uiManager:update\", \"Cannot find the DOM element. Ignoring.\", compToUpd)();\n        return;\n      }\n      log(\"trace\", \"_uiUpdate:components-forEach\", `Element(s) to update. Count: ${elToUpd.length}`, elToUpd)();\n      if (!compToUpd.slot && compToUpd.payload)\n        compToUpd.slot = compToUpd.payload;\n      elToUpd.forEach((el) => {\n        this._uiComposeComponent(el, compToUpd);\n      });\n      if (compToUpd.components) {\n        elToUpd.forEach((el) => {\n          log(\"trace\", \"_uiUpdate:components\", \"el\", el)();\n          this._uiUpdate({\n            method: ui.method,\n            parentEl: el,\n            components: compToUpd.components\n          });\n        });\n      }\n    });\n  }\n  // --- end of _uiUpdate ---\n  // TODO Add more error handling and parameter validation\n  /** Handle incoming _ui load requests\n   * Can load JavaScript modules, JavaScript scripts and CSS.\n   * @param {*} ui Standardised msg._ui property object. Note that payload and topic are appended to this object\n   */\n  _uiLoad(ui) {\n    if (ui.components) {\n      if (!Array.isArray(ui.components))\n        ui.components = [ui.components];\n      ui.components.forEach(async (component) => {\n        await import(component);\n      });\n    }\n    if (ui.srcScripts) {\n      if (!Array.isArray(ui.srcScripts))\n        ui.srcScripts = [ui.srcScripts];\n      ui.srcScripts.forEach((script) => {\n        this.loadScriptSrc(script);\n      });\n    }\n    if (ui.txtScripts) {\n      if (!Array.isArray(ui.txtScripts))\n        ui.txtScripts = [ui.txtScripts];\n      this.loadScriptTxt(ui.txtScripts.join(\"\\n\"));\n    }\n    if (ui.srcStyles) {\n      if (!Array.isArray(ui.srcStyles))\n        ui.srcStyles = [ui.srcStyles];\n      ui.srcStyles.forEach((sheet) => {\n        this.loadStyleSrc(sheet);\n      });\n    }\n    if (ui.txtStyles) {\n      if (!Array.isArray(ui.txtStyles))\n        ui.txtStyles = [ui.txtStyles];\n      this.loadStyleTxt(ui.txtStyles.join(\"\\n\"));\n    }\n  }\n  // --- end of _uiLoad ---\n  /** Handle a reload request */\n  _uiReload() {\n    log(\"trace\", \"Ui:uiManager:reload\", \"reloading\")();\n    location.reload();\n  }\n  /** Handle incoming _ui messages and loaded UI JSON files\n   * Called from start()\n   * @param {*} msg Standardised msg object containing a _ui property object\n   */\n  _uiManager(msg) {\n    if (!msg._ui)\n      return;\n    if (!Array.isArray(msg._ui))\n      msg._ui = [msg._ui];\n    msg._ui.forEach((ui, i) => {\n      if (!ui.method) {\n        log(\"error\", \"Ui:_uiManager\", `No method defined for msg._ui[${i}]. Ignoring`)();\n        return;\n      }\n      ui.payload = msg.payload;\n      ui.topic = msg.topic;\n      switch (ui.method) {\n        case \"add\": {\n          this._uiAdd(ui, false);\n          break;\n        }\n        case \"remove\": {\n          this._uiRemove(ui, false);\n          break;\n        }\n        case \"removeAll\": {\n          this._uiRemove(ui, true);\n          break;\n        }\n        case \"replace\": {\n          this._uiReplace(ui);\n          break;\n        }\n        case \"update\": {\n          this._uiUpdate(ui);\n          break;\n        }\n        case \"load\": {\n          this._uiLoad(ui);\n          break;\n        }\n        case \"reload\": {\n          this._uiReload();\n          break;\n        }\n        case \"notify\": {\n          this.showDialog(\"notify\", ui, msg);\n          break;\n        }\n        case \"alert\": {\n          this.showDialog(\"alert\", ui, msg);\n          break;\n        }\n        default: {\n          log(\"error\", \"Ui:_uiManager\", `Invalid msg._ui[${i}].method (${ui.method}). Ignoring`)();\n          break;\n        }\n      }\n    });\n  }\n  // --- end of _uiManager ---\n  /** Get standard data from a DOM node.\n   * @param {*} node DOM node to examine\n   * @param {string} cssSelector Identify the DOM element to get data from\n   * @returns {object} Standardised data object\n   */\n  nodeGet(node, cssSelector) {\n    const thisOut = {\n      id: node.id === \"\" ? void 0 : node.id,\n      name: node.name,\n      children: node.childNodes.length,\n      type: node.nodeName,\n      attributes: void 0,\n      isUserInput: node.validity ? true : false,\n      // eslint-disable-line no-unneeded-ternary\n      userInput: !node.validity ? void 0 : {\n        // eslint-disable-line multiline-ternary\n        value: node.value,\n        validity: void 0,\n        willValidate: node.willValidate,\n        valueAsDate: node.valueAsDate,\n        valueAsNumber: node.valueAsNumber,\n        type: node.type\n      }\n    };\n    if ([\"UL\", \"OL\"].includes(node.nodeName)) {\n      const listEntries = document.querySelectorAll(`${cssSelector} li`);\n      if (listEntries) {\n        thisOut.list = {\n          \"entries\": listEntries.length\n        };\n      }\n    }\n    if (node.nodeName === \"DL\") {\n      const listEntries = document.querySelectorAll(`${cssSelector} dt`);\n      if (listEntries) {\n        thisOut.list = {\n          \"entries\": listEntries.length\n        };\n      }\n    }\n    if (node.nodeName === \"TABLE\") {\n      const bodyEntries = document.querySelectorAll(`${cssSelector} > tbody > tr`);\n      const headEntries = document.querySelectorAll(`${cssSelector} > thead > tr`);\n      const cols = document.querySelectorAll(`${cssSelector} > tbody > tr:last-child > *`);\n      if (bodyEntries || headEntries || cols) {\n        thisOut.table = {\n          \"headRows\": headEntries ? headEntries.length : 0,\n          \"bodyRows\": bodyEntries ? bodyEntries.length : 0,\n          \"columns\": cols ? cols.length : 0\n        };\n      }\n    }\n    if (node.nodeName !== \"#text\" && node.attributes && node.attributes.length > 0) {\n      thisOut.attributes = {};\n      for (const attrib of node.attributes) {\n        if (attrib.name !== \"id\") {\n          thisOut.attributes[attrib.name] = node.attributes[attrib.name].value;\n        }\n      }\n    }\n    if (node.nodeName === \"#text\") {\n      thisOut.text = node.textContent;\n    }\n    if (node.validity)\n      thisOut.userInput.validity = {};\n    for (const v in node.validity) {\n      thisOut.userInput.validity[v] = node.validity[v];\n    }\n    return thisOut;\n  }\n  // --- end of nodeGet --- //\n  /** Get data from the DOM. Returns selection of useful props unless a specific prop requested.\n   * @param {string} cssSelector Identify the DOM element to get data from\n   * @param {string} [propName] Optional. Specific name of property to get from the element\n   * @returns {Array<*>} Array of objects containing either specific requested property or a selection of useful properties\n   */\n  uiGet(cssSelector, propName = null) {\n    const selection = (\n      /** @type {NodeListOf<HTMLInputElement>} */\n      document.querySelectorAll(cssSelector)\n    );\n    const out = [];\n    selection.forEach((node) => {\n      if (propName !== null && propName !== \"\") {\n        let prop = node.getAttribute(propName);\n        if (prop === void 0 || prop === null) {\n          try {\n            prop = node[propName];\n          } catch (error) {\n          }\n        }\n        if (prop === void 0 || prop === null) {\n          if (propName.toLowerCase() === \"value\")\n            out.push(node.innerText);\n          else\n            out.push(`Property '${propName}' not found`);\n        } else {\n          if (prop.constructor.name === \"NamedNodeMap\") {\n            const p = {};\n            for (const key of prop) {\n              p[key.name] = prop[key.name].value;\n            }\n            out.push(p);\n          } else if (!prop.constructor.name.toLowerCase().includes(\"map\")) {\n            out.push({\n              [propName]: prop\n            });\n          } else {\n            const p = {};\n            for (const key in prop) {\n              p[key] = prop[key];\n            }\n            out.push(p);\n          }\n        }\n      } else {\n        out.push(this.nodeGet(node, cssSelector));\n      }\n    });\n    return out;\n  }\n  // --- end of uiGet --- //\n  /** Include HTML fragment, img, video, text, json, form data, pdf or anything else from an external file or API\n   * Wraps the included object in a div tag.\n   * PDF's, text or unknown MIME types are also wrapped in an iFrame.\n   * @param {string} url The URL of the source file to include\n   * @param {object} uiOptions Object containing properties recognised by the _uiReplace function. Must at least contain an id\n   * param {string} uiOptions.id The HTML ID given to the wrapping DIV tag\n   * param {string} uiOptions.parentSelector The CSS selector for a parent element to insert the new HTML under (defaults to 'body')\n   * @returns {Promise<any>} Status\n   */\n  async include(url, uiOptions) {\n    if (!fetch) {\n      log(0, \"Ui:include\", \"Current environment does not include `fetch`, skipping.\")();\n      return \"Current environment does not include `fetch`, skipping.\";\n    }\n    if (!url) {\n      log(0, \"Ui:include\", \"url parameter must be provided, skipping.\")();\n      return \"url parameter must be provided, skipping.\";\n    }\n    if (!uiOptions || !uiOptions.id) {\n      log(0, \"Ui:include\", \"uiOptions parameter MUST be provided and must contain at least an `id` property, skipping.\")();\n      return \"uiOptions parameter MUST be provided and must contain at least an `id` property, skipping.\";\n    }\n    let response;\n    try {\n      response = await fetch(url);\n    } catch (error) {\n      log(0, \"Ui:include\", `Fetch of file '${url}' failed. `, error.message)();\n      return error.message;\n    }\n    if (!response.ok) {\n      log(0, \"Ui:include\", `Fetch of file '${url}' failed. Status='${response.statusText}'`)();\n      return response.statusText;\n    }\n    const contentType = await response.headers.get(\"content-type\");\n    let type = null;\n    if (contentType) {\n      if (contentType.includes(\"text/html\")) {\n        type = \"html\";\n      } else if (contentType.includes(\"application/json\")) {\n        type = \"json\";\n      } else if (contentType.includes(\"multipart/form-data\")) {\n        type = \"form\";\n      } else if (contentType.includes(\"image/\")) {\n        type = \"image\";\n      } else if (contentType.includes(\"video/\")) {\n        type = \"video\";\n      } else if (contentType.includes(\"application/pdf\")) {\n        type = \"pdf\";\n      } else if (contentType.includes(\"text/plain\")) {\n        type = \"text\";\n      }\n    }\n    let slot = \"\";\n    let txtReturn = \"Include successful\";\n    let data;\n    switch (type) {\n      case \"html\": {\n        data = await response.text();\n        slot = data;\n        break;\n      }\n      case \"json\": {\n        data = await response.json();\n        slot = '<pre class=\"syntax-highlight\">';\n        slot += this.syntaxHighlight(data);\n        slot += \"</pre>\";\n        break;\n      }\n      case \"form\": {\n        data = await response.formData();\n        slot = '<pre class=\"syntax-highlight\">';\n        slot += this.syntaxHighlight(data);\n        slot += \"</pre>\";\n        break;\n      }\n      case \"image\": {\n        data = await response.blob();\n        slot = `<img src=\"${URL.createObjectURL(data)}\">`;\n        if (window && window[\"DOMPurify\"]) {\n          txtReturn = \"Include successful. BUT DOMPurify loaded which may block its use.\";\n          log(\"warn\", \"Ui:include:image\", txtReturn)();\n        }\n        break;\n      }\n      case \"video\": {\n        data = await response.blob();\n        slot = `<video controls autoplay><source src=\"${URL.createObjectURL(data)}\"></video>`;\n        if (window && window[\"DOMPurify\"]) {\n          txtReturn = \"Include successful. BUT DOMPurify loaded which may block its use.\";\n          log(\"warn\", \"Ui:include:video\", txtReturn)();\n        }\n        break;\n      }\n      case \"pdf\":\n      case \"text\":\n      default: {\n        data = await response.blob();\n        slot = `<iframe style=\"resize:both;width:inherit;height:inherit;\" src=\"${URL.createObjectURL(data)}\">`;\n        if (window && window[\"DOMPurify\"]) {\n          txtReturn = \"Include successful. BUT DOMPurify loaded which may block its use.\";\n          log(\"warn\", `Ui:include:${type}`, txtReturn)();\n        }\n        break;\n      }\n    }\n    uiOptions.type = \"div\";\n    uiOptions.slot = slot;\n    if (!uiOptions.parent)\n      uiOptions.parent = \"body\";\n    if (!uiOptions.attributes)\n      uiOptions.attributes = { class: \"included\" };\n    this._uiReplace({\n      components: [\n        uiOptions\n      ]\n    });\n    log(\"trace\", `Ui:include:${type}`, txtReturn)();\n    return txtReturn;\n  }\n  // ---- End of include() ---- //\n};\nmodule.exports = Ui;\n"],
  "mappings": "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",
  "names": ["log", "Ui", "extLog", "jsonHighlight", "json", "msg", "el", "component", "opts", "str", "lang", "md", "url", "newScript", "newStyle", "textFn", "type", "ui", "content", "toaster", "toast", "evt", "config", "notify", "resolve", "reject", "ev", "permit", "response", "contentType", "data", "err", "comp", "attrib", "prop", "parentEl", "components", "ns", "compToAdd", "i", "newEl", "isRecurse", "elParent", "all", "compToRemove", "els", "compToReplace", "elToReplace", "compToUpd", "elToUpd", "script", "sheet", "node", "cssSelector", "thisOut", "listEntries", "bodyEntries", "headEntries", "cols", "v", "propName", "selection", "out", "p", "key", "uiOptions", "error", "slot", "txtReturn"]
}
